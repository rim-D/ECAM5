<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>2. 함수형프로그래밍 전환하기</title>
</head>
<body>

  <script>

  var users = [
    { id: 1, name: 'ID', age: 36 },
    { id: 2, name: 'BJ', age: 32 },
    { id: 3, name: 'JM', age: 32 },
    { id: 4, name: 'PJ', age: 27 },
    { id: 5, name: 'HA', age: 25 },
    { id: 6, name: 'JE', age: 26 },
    { id: 7, name: 'JI', age: 31 },
    { id: 8, name: 'MP', age: 23 },
  ]    

  // 1. 명령형 코드
    // 1-1. 30세 이상인 users를 거른다.
    var tempUsers = [];
    for (var i = 0; i < users.length; i++) {
      if ( users[i].age >= 30 ) {
        tempUsers.push(users[i]);
      }
    }
    console.log(tempUsers);

    // 1-2. 30세 이상인 users의 newList를 수집한다.
    var tempUser = [];
    for (var i = 0; i < tempUsers.length; i++) {
      console.log(tempUsers.length);
      if ( tempUsers[i].age >= 30 ) {
        tempUser.push(tempUsers[i].name);
      }
    }
    console.log(tempUser);

    // 1-3. 30세 미만인 users를 거른다.
    var tempUsers = [];
    for (var i = 0; i < users.length; i++) {
      if ( users[i].age < 30 ) {
        tempUsers.push(users[i]);
      }
    }
    console.log(tempUsers);

    // 1-4. 30세 미만인 users의 ages를 수집한다.
    var tempUsersAges = [];
    for (var i = 0; i < tempUsers.length; i++) {
      if ( tempUsers[i].age < 30 ) {
        tempUsersAges.push(tempUsers[i].age);
      }
    }
    console.log(tempUsersAges);


  // 2. _filter, _map으로 리팩토링
  // 고차함수 -> 함수를 인자로 받는 경우나
  function _filter(list, predi) {
    var newList = [];
    for (var i = 0; i < list.length; i++) {
      if (predi(list[i])) {
        newList.push(list[i]);
      }
    }
    return newList;
  }

  function _map(list, mapper) {
    var newList = [];
    for (var i = 0; i < list.length; i++ ) {
      newList.push(mapper(list[i]));
    }
    return newList;
  }

  console.log(
    '30세 이상 ==',
    _filter(users, function(user) { return user.age >= 30; }));

  console.log(
    '30세 미만 ==',
    _filter(users, function(user) { return user.age < 30; }));


  var over_30 = _filter(users, function(user) { return user.age >= 30; })
  console.log(over_30);

  var over_30_names = _map(over_30, function(user) { return user.name; })
  console.log(over_30_names);

  var under_30 = _filter(users, function(user) { return user.age < 30; })
  console.log(under_30);

  var under_30_ages = _map(under_30, function(user) { return user.age; })
  console.log(under_30_ages);
  // console.log(
  //   '짝수 ==',
  //   _filter([1, 2, 3, 4], function(num) { return num % 2; }));
  
  // console.log(
  //   '홀수 ==',
  //   _filter([1, 2, 3, 4], function(num) { return !(num % 2); }));


  console.log(
    '_map + _filter==== ',
    _map(
      _filter(users, function(user) { return user.age >= 30 }),
      function(user) { return user.name}
    )
  );

  console.log(
    '_map + _filter==== ',
    _map(
      _filter(users, function(user) { return user.age < 30 }),
      function(user) { return user.age}
    )
  )


  // 3. each만들기


  </script>
</body>
</html>